import{b as Y,c as $,d as j,e as q,f as z,g as U}from"./chunk-DY7DWGHU.js";import{a as V,b as W,c as B}from"./chunk-S76Z7UMZ.js";import{d as D,f as N,g as A}from"./chunk-7INUDOVH.js";import{$ as h,Fa as w,Gb as k,Hb as O,Jb as P,Ka as u,Ra as l,Ta as t,Ua as n,Va as S,Wa as T,Xa as C,Ya as f,aa as _,ab as b,bb as a,c as M,cb as c,db as v,eb as E,fb as L,gb as I,hb as y,kb as x,nb as F,wa as r,xa as R}from"./chunk-NP4V3FYK.js";var G=i=>["/drivers",i],H=i=>["/teams",i];function Z(i,d){if(i&1&&(t(0,"option",17),a(1),n()),i&2){let e=d.$implicit;l("value",e),r(),c(e)}}function J(i,d){if(i&1&&(t(0,"option",17),a(1),n()),i&2){let e=d.$implicit;l("value",e.round),r(),c(e.raceName)}}function K(i,d){i&1&&(t(0,"div"),S(1,"app-loading-spinner",18),n()),i&2&&(r(),l("message","Loading race results..."))}function Q(i,d){if(i&1&&(t(0,"div",21),S(1,"app-error-message",18),n()),i&2){let e=f(2);r(),l("message",e.error)}}function X(i,d){if(i&1&&(t(0,"span"),a(1),n()),i&2){let e=f().$implicit;r(),c(e.Time.time)}}function ee(i,d){if(i&1&&(t(0,"span",36),a(1),n()),i&2){let e=f().$implicit;r(),c(e.status)}}function te(i,d){if(i&1&&(t(0,"tr")(1,"td"),a(2),n(),t(3,"td")(4,"a",32),a(5),t(6,"span",33),a(7),n()()(),t(8,"td")(9,"a",34),a(10),n()(),t(11,"td",28),a(12),n(),t(13,"td",28),a(14),n(),t(15,"td"),u(16,X,2,1,"span",16)(17,ee,2,1,"ng-template",null,1,F),n(),t(19,"td",35),a(20),n()()),i&2){let e=d.$implicit,o=b(18);r(2),c(e.position),r(2),l("routerLink",x(11,G,e.Driver.driverId)),r(),v(" ",e.Driver.givenName," "),r(2),c(e.Driver.familyName),r(2),l("routerLink",x(13,H,e.Constructor.constructorId)),r(),v(" ",e.Constructor.name," "),r(2),c(e.grid),r(2),c(e.laps),r(2),l("ngIf",e.Time)("ngIfElse",o),r(4),c(e.points)}}function ne(i,d){if(i&1&&(t(0,"tr")(1,"td"),a(2),n(),t(3,"td")(4,"a",32),a(5),t(6,"span",33),a(7),n()()(),t(8,"td")(9,"a",34),a(10),n()(),t(11,"td",28),a(12),n(),t(13,"td",28),a(14),n(),t(15,"td",29),a(16),n()()),i&2){let e=d.$implicit;r(2),c(e.FastestLap==null?null:e.FastestLap.rank),r(2),l("routerLink",x(10,G,e.Driver.driverId)),r(),v(" ",e.Driver.givenName," "),r(2),c(e.Driver.familyName),r(2),l("routerLink",x(12,H,e.Constructor.constructorId)),r(),v(" ",e.Constructor.name," "),r(2),v(`
`,(e.FastestLap==null?null:e.FastestLap.lap)||"N/A",`
`),r(2),v(`
`,(e.FastestLap==null||e.FastestLap.Time==null?null:e.FastestLap.Time.time)||"N/A",`
`),r(2),E(`
`,(e.FastestLap==null||e.FastestLap.AverageSpeed==null?null:e.FastestLap.AverageSpeed.speed)||"N/A"," ",(e.FastestLap==null||e.FastestLap.AverageSpeed==null?null:e.FastestLap.AverageSpeed.units)||"N/A",`
`)}}function ie(i,d){if(i&1&&(t(0,"div",37)(1,"h3",38),a(2,"Fastest Laps"),n(),t(3,"div",39)(4,"div",26)(5,"table",27)(6,"thead")(7,"tr")(8,"th"),a(9,"Rank"),n(),t(10,"th"),a(11,"Driver"),n(),t(12,"th"),a(13,"Team"),n(),t(14,"th",28),a(15,"Lap"),n(),t(16,"th",28),a(17,"Time"),n(),t(18,"th",29),a(19,"Avg Speed"),n()()(),t(20,"tbody"),u(21,ne,17,14,"tr",30),n()()()()()),i&2){let e=f(3);r(21),l("ngForOf",e.getFastestLapsResults())}}function ae(i,d){if(i&1&&(t(0,"div")(1,"div",22)(2,"h2"),a(3),n(),t(4,"div",23)(5,"span"),a(6),n(),t(7,"span",24),a(8,"|"),n(),t(9,"span"),a(10),n()()(),t(11,"div",25)(12,"div",26)(13,"table",27)(14,"thead")(15,"tr")(16,"th"),a(17,"Pos"),n(),t(18,"th"),a(19,"Driver"),n(),t(20,"th"),a(21,"Team"),n(),t(22,"th",28),a(23,"Grid"),n(),t(24,"th",28),a(25,"Laps"),n(),t(26,"th"),a(27,"Time/Retired"),n(),t(28,"th",29),a(29,"Points"),n()()(),t(30,"tbody"),u(31,te,21,15,"tr",30),n()()()(),u(32,ie,22,1,"div",31),n()),i&2){let e=f(2);r(3),E("",e.raceResult.raceName," ",e.raceResult.season,""),r(3),c(e.raceResult.Circuit.circuitName),r(4),c(e.formatDate(e.raceResult.date)),r(21),l("ngForOf",e.raceResult.Results),r(),l("ngIf",e.hasFastestLaps())}}function re(i,d){if(i&1&&u(0,Q,2,1,"div",19)(1,ae,33,6,"div",20),i&2){let e=f();l("ngIf",e.error),r(),l("ngIf",!e.error&&e.raceResult)}}var ve=(()=>{class i{constructor(e,o,s){this.f1Service=e,this.route=o,this.router=s,this.races=[],this.isLoadingRaces=!0,this.raceResult=null,this.isLoadingResults=!0,this.error="",this.selectedSeason=2024,this.selectedRound=1,this.availableYears=[];let m=2024;for(let p=m;p>=2e3;p--)this.availableYears.push(p)}ngOnInit(){this.route.queryParams.subscribe(e=>{e.season&&(this.selectedSeason=parseInt(e.season,10)),this.loadRaces().then(()=>{if(e.round)this.selectedRound=parseInt(e.round,10);else if(this.races.length>0){let o=new Date,s=this.races.filter(m=>new Date(`${m.date}T${m.time||"00:00:00Z"}`)<o);s.length>0?this.selectedRound=parseInt(s[s.length-1].round,10):this.selectedRound=parseInt(this.races[0].round,10)}this.loadResults()})})}loadRaces(){return M(this,null,function*(){return new Promise(e=>{this.isLoadingRaces=!0,this.f1Service.getSeasonSchedule(this.selectedSeason).subscribe({next:o=>{this.races=o.MRData.RaceTable.Races,this.isLoadingRaces=!1,e()},error:o=>{console.error("Error loading race schedule:",o),this.isLoadingRaces=!1,e()}})})})}onSeasonChange(){this.loadRaces().then(()=>{this.races.length>0&&(this.selectedRound=parseInt(this.races[0].round,10),this.loadResults())})}loadResults(){this.isLoadingResults=!0,this.error="",this.router.navigate([],{relativeTo:this.route,queryParams:{season:this.selectedSeason,round:this.selectedRound},queryParamsHandling:"merge"}),this.f1Service.getRaceResults(this.selectedSeason,this.selectedRound).subscribe({next:e=>{e.MRData.RaceTable.Races.length>0?this.raceResult=e.MRData.RaceTable.Races[0]:(this.raceResult=null,this.error="No results found for this race."),this.isLoadingResults=!1},error:e=>{console.error("Error loading race results:",e),this.error="Unable to load race results. Please try again later.",this.isLoadingResults=!1}})}formatDate(e){return e?new Date(e).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):""}hasFastestLaps(){return!this.raceResult||!this.raceResult.Results?!1:this.raceResult.Results.some(e=>e.FastestLap)}getFastestLapsResults(){return!this.raceResult||!this.raceResult.Results?[]:this.raceResult.Results.filter(o=>o.FastestLap).sort((o,s)=>{let m=o.FastestLap?parseInt(o.FastestLap.rank,10):999,p=s.FastestLap?parseInt(s.FastestLap.rank,10):999;return m-p})}static{this.\u0275fac=function(o){return new(o||i)(R(B),R(D),R(N))}}static{this.\u0275cmp=w({type:i,selectors:[["app-results"]],decls:25,vars:7,consts:[["resultsContent",""],["statusBlock",""],[1,"page-transition"],[1,"page-header","bg-f1-blue","text-white","mb-4"],[1,"container"],[1,"mb-2"],[1,"mb-0"],[1,"filters-container","mb-4"],[1,"row"],[1,"col-md-4"],[1,"form-group"],["for","seasonSelect",1,"form-label"],["id","seasonSelect",1,"form-control",3,"ngModelChange","change","ngModel"],[3,"value",4,"ngFor","ngForOf"],["for","roundSelect",1,"form-label"],["id","roundSelect",1,"form-control",3,"ngModelChange","change","ngModel","disabled"],[4,"ngIf","ngIfElse"],[3,"value"],[3,"message"],["class","mb-4",4,"ngIf"],[4,"ngIf"],[1,"mb-4"],[1,"result-header","mb-4"],[1,"circuit-info"],[1,"mx-2"],[1,"f1-card","mb-4"],[1,"table-responsive"],[1,"f1-table"],[1,"text-center"],[1,"text-end"],[4,"ngFor","ngForOf"],["class","fastest-laps mb-4",4,"ngIf"],[1,"driver-link",3,"routerLink"],[1,"text-uppercase","fw-bold"],[1,"team-link",3,"routerLink"],[1,"text-end","fw-bold"],[1,"status-text"],[1,"fastest-laps","mb-4"],[1,"section-title","mb-3"],[1,"f1-card"]],template:function(o,s){if(o&1){let m=T();t(0,"div",2)(1,"div",3)(2,"div",4)(3,"h1",5),a(4,"Race Results"),n(),t(5,"p",6),a(6,"Formula 1 Race Results"),n()()(),t(7,"div",4)(8,"div",7)(9,"div",8)(10,"div",9)(11,"div",10)(12,"label",11),a(13,"Season"),n(),t(14,"select",12),y("ngModelChange",function(g){return h(m),I(s.selectedSeason,g)||(s.selectedSeason=g),_(g)}),C("change",function(){return h(m),_(s.onSeasonChange())}),u(15,Z,2,2,"option",13),n()()(),t(16,"div",9)(17,"div",10)(18,"label",14),a(19,"Race"),n(),t(20,"select",15),y("ngModelChange",function(g){return h(m),I(s.selectedRound,g)||(s.selectedRound=g),_(g)}),C("change",function(){return h(m),_(s.loadResults())}),u(21,J,2,2,"option",13),n()()()()(),u(22,K,2,1,"div",16)(23,re,2,2,"ng-template",null,0,F),n()()}if(o&2){let m=b(24);r(14),L("ngModel",s.selectedSeason),r(),l("ngForOf",s.availableYears),r(5),L("ngModel",s.selectedRound),l("disabled",s.isLoadingRaces),r(),l("ngForOf",s.races),r(),l("ngIf",s.isLoadingResults)("ngIfElse",m)}},dependencies:[P,k,O,U,q,z,j,Y,$,A,V,W],styles:['.page-header[_ngcontent-%COMP%]{padding:3rem 0;margin-top:-1rem;position:relative}.page-header[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:0;left:0;right:0;height:5px;background-color:var(--f1-red)}.filters-container[_ngcontent-%COMP%]{background-color:#fff;border-radius:8px;padding:1.5rem;box-shadow:0 2px 4px #0000000d}.form-label[_ngcontent-%COMP%]{font-weight:600;color:var(--f1-blue);margin-bottom:.5rem}.result-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;color:var(--f1-blue);margin-bottom:.5rem}.circuit-info[_ngcontent-%COMP%]{font-size:1.1rem;color:var(--f1-dark-gray)}.driver-link[_ngcontent-%COMP%], .team-link[_ngcontent-%COMP%]{color:var(--f1-blue);text-decoration:none;transition:color .2s}.driver-link[_ngcontent-%COMP%]:hover, .team-link[_ngcontent-%COMP%]:hover{color:var(--f1-red)}.status-text[_ngcontent-%COMP%]{color:var(--f1-medium-gray)}.section-title[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:var(--f1-blue);position:relative;padding-left:.75rem}.section-title[_ngcontent-%COMP%]:before{content:"";position:absolute;left:0;top:.25rem;bottom:.25rem;width:4px;background-color:var(--f1-red);border-radius:2px}']})}}return i})();export{ve as ResultsComponent};
