import{a as F,b as z,c as G}from"./chunk-S76Z7UMZ.js";import{d as k,g as A}from"./chunk-7INUDOVH.js";import{Fa as P,Gb as T,Hb as w,Jb as O,Ka as c,Ra as l,Ta as i,Ua as r,Va as p,Ya as v,ab as D,ba as C,bb as a,ca as y,cb as d,db as M,eb as L,nb as b,ta as N,wa as o,xa as h}from"./chunk-NP4V3FYK.js";function $(n,s){n&1&&(i(0,"div")(1,"div",4),p(2,"app-loading-spinner",5),r()()),n&2&&(o(2),l("message","Loading driver details..."))}function j(n,s){if(n&1&&(i(0,"div",4),p(1,"app-error-message",5),i(2,"div",8)(3,"a",9),a(4,"Back to Drivers"),r()()()),n&2){let e=v(2);o(),l("message",e.error)}}function q(n,s){if(n&1&&(i(0,"div",29),a(1),r()),n&2){let e=v(3);o(),d(e.driver.code)}}function V(n,s){n&1&&(i(0,"div"),p(1,"app-loading-spinner",5),r()),n&2&&(o(),l("message","Loading results..."))}function W(n,s){if(n&1&&(i(0,"div",32),p(1,"app-error-message",5),r()),n&2){let e=v(4);o(),l("message",e.resultsError)}}function Z(n,s){n&1&&(i(0,"div",33)(1,"p"),a(2,"No recent results available for this driver"),r()())}function J(n,s){if(n&1&&(i(0,"tr")(1,"td"),a(2),r(),i(3,"td"),a(4),r(),i(5,"td"),a(6),r(),i(7,"td",36),a(8),r(),i(9,"td",36),a(10),r(),i(11,"td",39),a(12),r()()),n&2){let e=s.$implicit,t=v(5);o(2),d(t.formatDate(e.date)),o(2),d(e.raceName),o(2),d(t.getConstructorName(e)),o(2),d(t.getDriverGrid(e)),o(2),d(t.getDriverPosition(e)),o(2),d(t.getDriverPoints(e))}}function K(n,s){if(n&1&&(i(0,"div")(1,"div",34)(2,"table",35)(3,"thead")(4,"tr")(5,"th"),a(6,"Date"),r(),i(7,"th"),a(8,"Grand Prix"),r(),i(9,"th"),a(10,"Team"),r(),i(11,"th",36),a(12,"Grid"),r(),i(13,"th",36),a(14,"Position"),r(),i(15,"th",37),a(16,"Points"),r()()(),i(17,"tbody"),c(18,J,13,6,"tr",38),r()()()()),n&2){let e=v(4);o(18),l("ngForOf",e.driverResults)}}function Q(n,s){if(n&1&&c(0,W,2,1,"div",30)(1,Z,3,0,"div",31)(2,K,19,1,"div",7),n&2){let e=v(3);l("ngIf",e.resultsError),o(),l("ngIf",!e.resultsError&&e.driverResults.length===0),o(),l("ngIf",e.driverResults.length>0)}}function X(n,s){if(n&1&&(i(0,"div")(1,"div",10)(2,"div",11)(3,"div",12)(4,"a",13),C(),i(5,"svg",14),p(6,"path",15),r()(),y(),i(7,"h1",16),a(8),i(9,"span",17),a(10),r()()(),c(11,q,2,1,"div",18),r()(),i(12,"div",11)(13,"div",19)(14,"div",20)(15,"div",21)(16,"h3",22),a(17,"Driver Info"),r(),i(18,"div",23)(19,"div",24),a(20,"Full Name"),r(),i(21,"div",25),a(22),r()(),i(23,"div",23)(24,"div",24),a(25,"Nationality"),r(),i(26,"div",25),a(27),r()(),i(28,"div",23)(29,"div",24),a(30,"Date of Birth"),r(),i(31,"div",25),a(32),r()(),i(33,"div",23)(34,"div",24),a(35,"Driver Number"),r(),i(36,"div",25),a(37),r()(),i(38,"div",23)(39,"div",24),a(40,"Code"),r(),i(41,"div",25),a(42),r()(),i(43,"div",8)(44,"a",26),a(45,"Wikipedia Profile"),r()()()(),i(46,"div",27)(47,"div",28)(48,"h3",22),a(49,"Recent Results"),r(),c(50,V,2,1,"div",3)(51,Q,3,3,"ng-template",null,1,b),r()()()()()),n&2){let e=D(52),t=v(2);o(8),M("",t.driver.givenName," "),o(2),d(t.driver.familyName),o(),l("ngIf",t.driver.code),o(11),L("",t.driver.givenName," ",t.driver.familyName,""),o(5),d(t.driver.nationality),o(5),d(t.formatDate(t.driver.dateOfBirth)),o(5),d(t.driver.permanentNumber||"N/A"),o(5),d(t.driver.code||"N/A"),o(2),l("href",t.driver.url,N),o(6),l("ngIf",t.isLoadingResults)("ngIfElse",e)}}function Y(n,s){if(n&1&&c(0,j,5,1,"div",6)(1,X,53,12,"div",7),n&2){let e=v();l("ngIf",e.error),o(),l("ngIf",!e.error&&e.driver)}}var de=(()=>{class n{constructor(e,t){this.route=e,this.f1Service=t,this.driverId="",this.driver=null,this.isLoadingDriver=!0,this.error="",this.driverResults=[],this.isLoadingResults=!0,this.resultsError=""}ngOnInit(){this.driverId=this.route.snapshot.paramMap.get("id")||"",this.driverId?this.loadDriverDetails():(this.error="Driver ID is required",this.isLoadingDriver=!1)}loadDriverDetails(){this.isLoadingDriver=!0,this.error="",this.f1Service.getDriverDetails(this.driverId).subscribe({next:e=>{e.MRData.DriverTable.Drivers.length>0?(this.driver=e.MRData.DriverTable.Drivers[0],this.loadDriverResults()):this.error="Driver not found",this.isLoadingDriver=!1},error:e=>{console.error("Error loading driver details:",e),this.error="Unable to load driver details. Please try again later.",this.isLoadingDriver=!1}})}loadDriverResults(){this.isLoadingResults=!0,this.resultsError="",this.f1Service.getSeasonSchedule(2024).subscribe({next:t=>{let m=t.MRData.RaceTable.Races,g=new Date,I=m.filter(u=>new Date(`${u.date}T${u.time||"00:00:00Z"}`)<g);if(I.length>0){let E=I.slice(-5).reverse().map(f=>{let _=parseInt(f.season,10),B=parseInt(f.round,10);return new Promise(x=>{this.f1Service.getRaceResults(_,B).subscribe({next:S=>{if(S.MRData.RaceTable.Races.length>0){let R=S.MRData.RaceTable.Races[0],U=R.Results.some(H=>H.Driver.driverId===this.driverId);x(U?R:null)}else x(null)},error:()=>x(null)})})});Promise.all(E).then(f=>{this.driverResults=f.filter(_=>_!==null),this.isLoadingResults=!1})}else this.driverResults=[],this.isLoadingResults=!1},error:t=>{console.error("Error loading race schedule:",t),this.resultsError="Unable to load driver results. Please try again later.",this.isLoadingResults=!1}})}formatDate(e){return e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A"}getConstructorName(e){if(!e.Results)return"N/A";let t=e.Results.find(m=>m.Driver.driverId===this.driverId);return t?t.Constructor.name:"N/A"}getDriverGrid(e){if(!e.Results)return"N/A";let t=e.Results.find(m=>m.Driver.driverId===this.driverId);return t?t.grid:"N/A"}getDriverPosition(e){if(!e.Results)return"N/A";let t=e.Results.find(m=>m.Driver.driverId===this.driverId);return t?t.position:"N/A"}getDriverPoints(e){if(!e.Results)return"N/A";let t=e.Results.find(m=>m.Driver.driverId===this.driverId);return t?t.points:"N/A"}static{this.\u0275fac=function(t){return new(t||n)(h(k),h(G))}}static{this.\u0275cmp=P({type:n,selectors:[["app-driver-detail"]],decls:4,vars:2,consts:[["driverContent",""],["resultsContent",""],[1,"page-transition"],[4,"ngIf","ngIfElse"],[1,"container","py-5"],[3,"message"],["class","container py-5",4,"ngIf"],[4,"ngIf"],[1,"mt-4"],["routerLink","/drivers",1,"btn","f1-btn","f1-btn-primary"],[1,"driver-header","bg-f1-blue","text-white","mb-4"],[1,"container"],[1,"d-flex","align-items-center","mb-3"],["routerLink","/drivers",1,"text-white","me-3","back-link"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","fill","currentColor","viewBox","0 0 16 16"],["fill-rule","evenodd","d","M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8z"],[1,"mb-0"],[1,"text-uppercase"],["class","driver-code",4,"ngIf"],[1,"row","mb-5"],[1,"col-md-4","mb-4","mb-md-0"],[1,"f1-card","h-100"],[1,"card-title"],[1,"info-item"],[1,"info-label"],[1,"info-value"],["target","_blank",1,"btn","f1-btn","f1-btn-secondary",3,"href"],[1,"col-md-8"],[1,"f1-card","recent-results"],[1,"driver-code"],["class","mb-4",4,"ngIf"],["class","text-center my-4",4,"ngIf"],[1,"mb-4"],[1,"text-center","my-4"],[1,"table-responsive"],[1,"f1-table"],[1,"text-center"],[1,"text-end"],[4,"ngFor","ngForOf"],[1,"text-end","fw-bold"]],template:function(t,m){if(t&1&&(i(0,"div",2),c(1,$,3,1,"div",3)(2,Y,2,2,"ng-template",null,0,b),r()),t&2){let g=D(3);o(),l("ngIf",m.isLoadingDriver)("ngIfElse",g)}},dependencies:[O,T,w,A,F,z],styles:['.driver-header[_ngcontent-%COMP%]{padding:3rem 0;margin-top:-1rem;position:relative}.driver-header[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:0;left:0;right:0;height:5px;background-color:var(--f1-red)}.back-link[_ngcontent-%COMP%]{display:inline-flex;align-items:center;text-decoration:none;transition:transform .2s}.back-link[_ngcontent-%COMP%]:hover{transform:translate(-5px)}.driver-code[_ngcontent-%COMP%]{font-size:3rem;font-weight:800;opacity:.5}.card-title[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;margin-bottom:1.5rem;padding-bottom:.75rem;border-bottom:2px solid var(--f1-light-gray);color:var(--f1-blue)}.f1-card[_ngcontent-%COMP%]{padding:1.5rem}.info-item[_ngcontent-%COMP%]{margin-bottom:1.25rem}.info-label[_ngcontent-%COMP%]{font-size:.85rem;color:var(--f1-medium-gray);margin-bottom:.25rem}.info-value[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;color:var(--f1-blue)}.recent-results[_ngcontent-%COMP%]{height:100%}']})}}return n})();export{de as DriverDetailComponent};
